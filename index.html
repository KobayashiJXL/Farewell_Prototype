<script>
  // 自动加载 1.jpg ~ 60.jpg（如你放在 images/ 文件夹，请改成 `images/${i+1}.jpg`）
  const images = Array.from({length: 60}, (_, i) => `${i+1}.jpg`);

  // 配置选项
  const AUTO_SLIDE_INTERVAL = 5000; // 自动切换间隔（毫秒），0 = 不自动切换
  const PRELOAD_AHEAD = 1; // 预加载后面的几张图片（建议 1~3）

  // 元素引用
  const imgEl = document.getElementById('slideshow');
  const prevBtn = document.getElementById('prev-btn');
  const nextBtn = document.getElementById('next-btn');

  let current = 0;
  let autoSlideTimer = null;
  let isHovering = false;

  // 切换图片（带淡入）
  function showImage(index) {
    if (!imgEl) return;
    index = (index + images.length) % images.length;
    current = index;

    imgEl.style.opacity = 0;
    setTimeout(() => {
      imgEl.src = images[current];
      imgEl.style.opacity = 1;
      preloadImages(current, PRELOAD_AHEAD);
    }, 200);
  }

  // 预加载下一张
  function preloadImages(startIndex, n) {
    for (let i = 1; i <= n; i++) {
      const idx = (startIndex + i) % images.length;
      const img = new Image();
      img.src = images[idx];
    }
  }

  // 上一张 / 下一张
  function prevImage() {
    showImage((current - 1 + images.length) % images.length);
  }
  function nextImage() {
    showImage((current + 1) % images.length);
  }

  // 按钮绑定
  if (prevBtn) prevBtn.addEventListener('click', () => {
    stopAutoSlideTemporary();
    prevImage();
  });
  if (nextBtn) nextBtn.addEventListener('click', () => {
    stopAutoSlideTemporary();
    nextImage();
  });

  // 自动轮播
  function startAutoSlide() {
    if (AUTO_SLIDE_INTERVAL > 0) {
      stopAutoSlide();
      autoSlideTimer = setInterval(() => {
        if (!isHovering) nextImage();
      }, AUTO_SLIDE_INTERVAL);
    }
  }

  function stopAutoSlide() {
    if (autoSlideTimer) {
      clearInterval(autoSlideTimer);
      autoSlideTimer = null;
    }
  }

  function stopAutoSlideTemporary() {
    stopAutoSlide();
    setTimeout(startAutoSlide, 8000); // 点击按钮后8秒再恢复自动播放
  }

  // 鼠标悬停暂停（电脑端）
  if (imgEl) {
    imgEl.addEventListener('mouseenter', () => { isHovering = true; });
    imgEl.addEventListener('mouseleave', () => { isHovering = false; });
    imgEl.addEventListener('touchstart', () => { isHovering = true; stopAutoSlideTemporary(); });
    imgEl.addEventListener('touchend', () => { isHovering = false; });
  }

  // 页面加载时初始化
  document.addEventListener('DOMContentLoaded', () => {
    showImage(0);
    startAutoSlide();
  });

  // 键盘左右键支持
  document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowLeft') {
      stopAutoSlideTemporary();
      prevImage();
    } else if (e.key === 'ArrowRight') {
      stopAutoSlideTemporary();
      nextImage();
    }
  });
</script>
